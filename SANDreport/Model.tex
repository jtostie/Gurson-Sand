\chapter{Model Formulation}
\label{model-form}

\textit{This section should begin with a short description about the
  origins of the model, including the desire to capture porous solid
  behavior related to void growth with an inelastic body. Then some
  comments about the thermodynamic motivation to place it within a
  hyperelastic framework. It should include sections on the flow rule
  and each piece of the void volume fraction evolution equation.}

\textit{TODO: Short description of the model and motivations behind}

\textit{TODO: add some comments on the thermodynamic motivation for hyperelastic framework}

In this section, the hyperelastic formulation of the shear-modified Gurson model is presented. The framework extends the small-deformation version presented in \cite{Nahshon2008, Nahshon2009} to a hyperelastic finite deformation formulation.

\section{Preliminaries for hyperelastic finite deformation formulation}

\subsection{Kinematic preliminaries}

To set the stage for the hyperelastic constitutive relation, the kinematic
preliminaries for finite deformation elastoplasticity are summarized
in this section, along with the quantities and relations used in
subsequent model development.

An essential feature of this elastoplasticity framework is the
multiplicative decomposition of deformation gradient $\bF$ into an
elastic part $\bF^e$ and a plastic part $\bF^p$

\begin{equation}
  \bF = \bF^e\bF^p.
\end{equation}

This decomposition introduces the notion of an intermediate local
configuration (\cf\ \cite{SimoHughes:98} and the references
therein for the motivation and micromechanical basis for such a
decomposition).

Next, we introduce a set of strain measures associated with the
multiplicative decomposition that will be used extensively in the
model development. First is the right Cauchy-Green tensor $\bC$, and
its plastic counterpart $\bC^p$, which are defined in the reference configuration

\begin{align}
  \bC &= \bF^T \bF,\\
  \bC^p &= \bF^{pT} \bF^p.
\end{align}

In the current configuration we consider the left
Cauchy-Green tensor $\bb$, and its elastic counterpart ${\bb}^e$

\begin{align}
  \bb &= \bF \bF^{T},\\
  \bb^e &= \bF^e \bF^{eT}.\label{eq:be}\\
\end{align}

The above fundamental strain measures are related via pull-back and
push-forward operations

\begin{equation}\label{eq:pullpush}
  \bC^{-p} =\bF^{-1} \bb^e \bF^{-T},~~\bb^e = \bF \bC^{-p} \bF^T.
\end{equation}

In metal plasticity, a standard assumption is that plastic flow
is isochoric (volume-preserving), \ie\ $\det(\bF^p)=1$, which implies

\begin{align}
  J = \det (\bF) = \det (\bF^e).
\end{align}

Defining $J^e=\det(\bF^e)$, we have the volume preserving part of the
elastic left Cauchy-Green tensor $\bar{\bb}^e$

\begin{equation}
  \bar{\bb}^e = J^{e^{-2/3}}\bb^e = J^{-2/3}\bb^e.
\end{equation}

\subsection{Hyperelastic constitutive relation}

The starting point of the hyperelastic constitutive relation is the assumption of the existence of the following strain-energy function

\begin{equation}
\Psi=\Psi^{\rm vol}[J^e] + \Psi^{\rm iso}[\bar{\bb}^e]
\end{equation}

Here the strain-energy function $\Psi$ is a decoupled function of the isochoric part (i.e., $\bar{\bb}^e$) and the volumetric part (i.e., $J^e=\det\bF^e$) of the elastic deformation. $\bb^e$ is the elastic left Cauchy-Green tensor defined in \eqref{eq:be}. The volumetric and the isochoric parts of the strain-energy function are given as

\begin{equation}
\Psi^{\rm vol}[J^e] =\frac{1}{2}\kappa(\ln J^e)^2,~~\Psi^{\rm iso}[\bar{\bb}^e] = \frac{1}{4}\mu\ln\bar{\bb}^e:\ln\bar{\bb}^e
\end{equation}

where $\kappa$ and $\mu$ are the bulk and shear modulus. Following the argument in \cite{Steinmann1994}, elastic logarithmic Henchky strains $\ln\bb^e$ is used as the strain measure, and the elastic constitutive law and the Kirchhoff stresses are given as

\begin{equation}\label{eq:Kirchhoff}
\btau=\kappa\ln J^e\bg^{-1} + \mu\ln\bar{\bb}^e = \kappa(\ln\bb^e:\bg)\bg^{-1} + \mu\dev\ln\bb^e
\end{equation}

where $\bg$ is the metric tensor. The Kirchhoff pressure $p$ and deviatoric stress tensor $\bs$ can be obtained

\begin{equation}\label{eq:p}
p = \frac{1}{3}\tr(\btau) = \frac{1}{2}\kappa\tr\ln\bb^e = \frac{1}{2}\kappa\ln\det\bb^e
\end{equation}

\begin{equation}\label{eq:s}
\bs = \dev(\btau) = \mu\dev\ln\bb^e
\end{equation}

\section{Constitutive relations of shear-modified Gurson model}

\subsection{Yield function and hardening law}
Within the previously described hyperelastic constitutive framework, the yield function $\Phi$ of the Gurson model can be written as

\begin{equation}\label{eq:Phi}
\Phi = \|\bs\| - \sqrt{\frac{2}{3}}{\rm sign}(\psi)\sqrt{|\psi|} Y
\end{equation}

where $\bs$ is the deviatoric Kirchhoff stress defined in Eq.\eqref{eq:s}. It should be noted that Eq.\eqref{eq:Phi} is a linear form (in terms of $\|\bs\|$) of the Gurson yield function . This particular form of Gurson yield function is implemented to facilitate comparisons with existing J2-like models in Albany analysis code [CITE], where the yield functions are also written as linear function of $\|\bs\|$. 

The function $\psi$ contains contributions from the damage in the material, which directly relates to the void volume fraction $f$ of the porous solid:

\begin{equation}
\psi = 1 + f^2 - 2 f \cosh(v), ~~v=\frac{3p}{2 Y}
\end{equation}

where $p$ is the Kirchhoff pressure defined in Eq.\eqref{eq:p}, and $f$ is the void volume fraction of the porous solid. The Kirchhoff yield stress $Y$ describes the hardening of the matrix material. One example of a nonlinear hardening law proposed by \cite{SimoHughes:98} for metal is written as 
\begin{equation}
Y =  Y_0 + Y_{\infty}\left[ 1-\exp(-\delta\varepsilon_q)\right] + K\varepsilon_q 
\end{equation}

where $\varepsilon_q$ is a strain-like internal variable (e.g., the equivalent plastic strain), $Y_0$ is the initial yield strength, $Y_{\infty}$ is the residual flow stress, $K$ is the hardening coefficient, and $\delta$ is the saturation exponent. Other forms of hardening law can also be used depending on the observed material behavior.

\subsection{Flow rule}
Following the standard procedure of the principle of maximum dissipation, \citep{Simo1992} proposed a general form of associate flow rule, which is adopted in the current formulation and is given as

\begin{equation}\label{eq:flowRule}
-\frac{1}{2}L_v(\bb^e)\cdot\bb^{e^{-1}} = \gamma\frac{\partial\Phi}{\partial\btau}=\gamma\bn + \frac{1}{3}t\tensor 1
\end{equation}

where $L_v(\bb_e)$ is the Lie derivative of the elastic left Cauchy-Green tensor $\bb^e$, and $\bn$ and $t$ are computed given the yield function \eqref{eq:Phi} as

\begin{align}
\bn &= \frac{\bs}{\|\bs\|}\label{eq:n}\\
t &= \tr \left( \gamma \frac{\partial\Phi}{\partial\btau}\right) = \sqrt{\frac{3}{2}}\gamma f \sinh (\frac{3p}{2 Y})\frac{1}{\sqrt{|\psi|}} {\rm sign}(\psi)\label{eq:t}
\end{align}

\subsection{Evolution of void volume fraction}
The internal variable $f$ is the void volume fraction and represents damage of the porous solid. Its evolution typically consists of a void growth part, $f_g$, and a void nucleation part, $f_{n}$.

\begin{equation}\label{eq:dotf}
\dot{f} = \dot{f}_g + \dot{f}_{n}\\
\end{equation}

For the void growth part $\dot{f}_g$, the shear-modified Gurson model by \cite{Nahshon2008} extends the original void growth law by adding the dependence on the third stress invariant. The evolution equation is given by

\begin{eqnarray}
\dot{f}_g &=& (1-f)\tr\left( \gamma\frac{\partial\Phi}{\partial\btau} \right) + k_{\omega}f\frac{\omega(\btau)}{\tau_e}\bs: \left( \gamma\frac{\partial\Phi}{\partial\btau} \right)\\
&=&(1-f)t + \gamma k_{\omega}f\frac{\omega(\btau)}{\tau_e} \|\bs\| \\
&=&(1-f)t + \sqrt{\frac{2}{3}}\gamma k_{\omega}f \omega(\btau)
\end{eqnarray}

where $\tau_e:=\sqrt{3/2}\|\bs\|$ is the effective deviatoric Kirchhoff stress, $k_{\omega}$ is a material constant that sets the magnitude of the damage growth rate in pure shear states \citep{Nahshon2008}. The function $\omega(\btau)$ includes the effect of the third stress invariant on void growth and is given as

\begin{equation}
\omega(\btau) = 1- \left(\frac{27J_3}{2\tau_e^3}\right)^2
\end{equation}
where $J_3:=\det(\bs)$ is the third invariant of deviatoric Kirchhoff stress tensor.

The increase in void volume fraction due to plastic strain controlled nucleation can be written as \cite{Chu1980}
\begin{equation}\label{eq:dotf_nu}
\dot{f}_{nu} = A \dot{\varepsilon}_q
\end{equation}
$A$ is proposed to have the following form
\begin{equation}
A(\varepsilon_q) =
	\begin{cases}
		\frac{f_N}{s_N\sqrt{2\pi}}\exp\left[ -\frac{1}{2}\left( \frac{\varepsilon_q - \epsilon_N}{s_N}\right)^2\right], & p \geq 0\\
		0,	  & p <0
	\end{cases}
\end{equation}

where the nucleation strain follows a normal distribution with a mean value $\epsilon_N$ and a standard deviation $s_N$ with the volume fraction of the nucleated voids given by $f_N$.\\

\subsection{Evolution equation for equivalent plastic strain}
The evolution equation for equivalent plastic strain (Equation \eqref{eq:dotf_nu}) is derived from the equivalence of plastic work increment in the matrix material and the macroscopic plastic work increment as

\begin{eqnarray}\label{eq:dotepsilon}
&&\dot{\varepsilon}_q Y(1-f) = \btau : \left( \gamma\frac{\partial\Phi}{\partial\btau} \right)\\
\Rightarrow &&\dot{\varepsilon}_q =\frac{1}{1-f}\left( \gamma\sqrt{\frac{2|\psi|}{3}} {\rm sign}(\psi) + \frac{p t}{Y} \right) 
\end{eqnarray}

\subsection{Summary of material parameters}
The material parameters for the modified Gurson model include
\begin{equation}
\bP = \left\lbrace  E, \nu, K, Y_0, Y_{\infty}, \delta, f_0, k_{\omega}, e_N, s_N, f_N\right\rbrace 
\end{equation}

% Local Variables:
% TeX-master: "GursonModel"
% mode: latex
% mode: flyspell
% End:
