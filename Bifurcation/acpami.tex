\documentclass[12pt]{article}

\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{alltt}
\usepackage{amsbsy}
\usepackage{amscd}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{boldtensors}
\usepackage{booktabs}
\usepackage{eepic}
\usepackage{epic}
\usepackage{epsfig}
\usepackage{euscript}
\usepackage{fancyhdr}
\usepackage{float}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{ifthen}
\usepackage{multirow}
\usepackage{supertabular}
\usepackage{times}
\usepackage{verbatim}
\usepackage{xspace}
\usepackage[colorlinks]{hyperref}
\usepackage[numbers,sort&compress]{natbib}
\usepackage[FIGBOTCAP,TABTOPCAP,bf,tight]{subfigure}

\usepackage[T1]{fontenc}
\usepackage{ae,aecompl}

\newtheorem{proposition}{Proposition}

\input{notation_defs.tex}

\numberwithin{equation}{section}
%\numberwithin{figure}{section}
%\numberwithin{subfigure}{section}

\begin{document}

%\setlength{\headheight}{15pt}
%\headsep = 4pt
%\pagestyle{fancyplain}

%\lhead
%[\fancyplain{}{\emph{A.Mota, Q.Chen, J.Foulk, J.Ostien}}]
%{\fancyplain{}{\emph{A.Mota, Q.Chen, J.Foulk, J.Ostien}}}

%\rhead
%[\fancyplain{} {\emph{Cartesian Parametrization for Material Instability}}]
%{\fancyplain{} {\emph{Cartesian Parametrization for Material Instability}}}

% Remove this in final version
%\lfoot
%[\fancyplain{}{\bf{DRAFT}}]
%{\fancyplain{}{\bf{DRAFT}}}

%\rfoot
%[\fancyplain{}{\bf{\today}}]
%{\fancyplain{}{\bf{\today}}}

\title{A Cartesian Parametrization for the Numerical Analysis of
  Material Instability}

\author{
  \Large Alejandro~Mota$^1$,
  Qiushi~Chen$^2$\thanks{Email: qiushi@clemson.edu},
  \\
  \Large James~W.~Foulk {III}$^1$,
  Jakob~T.~Ostien$^1$, Zhengshou Lai$^2$
  \\
  \\
  $^1$Mechanics of Materials Department\\
  Sandia National Laboratories\\
  Livermore CA 94550, USA\\
  \\
  $^2$Glenn Department of Civil Engineering\\
  Clemson University\\
  Clemson, SC 29631, USA\\
}

\date{\today}

\maketitle

\begin{abstract}
  We examine some common and uncommon parametrizations of the unit
  sphere $S^2 \subset {"R}^3$ within the context of material stability
  analysis by means of the singularity of the acoustic tensor. We then
  propose a Cartesian parametrization for vectors $\{~v \in {"R}^3 \,
  : \, ||~v||_{\infty} = 1\}$, \ie, the unit square. We use these
  vectors in lieu of unit normals to test for the loss of the
  ellipticity condition. This parametrization is used to construct a
  tensor that is the acoustic tensor multiplied by a scalar factor. It
  is shown that both tensors become singular at the same time and in
  the same planes in the presence of a material instability. The
  performance of the Cartesian parametrization is compared against the
  other parametrizations, with the results of these comparisons
  showing that in general the Cartesian parametrization is more robust
  and more numerically efficient than the other tested
  parametrizations.
\end{abstract}

\section{Introduction}
\label{sec:intro}

The numerical analysis of material instability plays an important role
in the understanding and simulation of material failure in solid
mechanics problems. A reliable and efficient method to determine the
onset of material instability and the bifurcation directions is
required whether one is interested in studying the instability itself
or to devise numerical regularization methods that prevent lack of
convergence once an instability is present (e.g.,
\cite{Simo.etal:1993, Oliver:1996a, Oliver:1996b,
  Armero.Garikipati:1996, Moes.Belytschko:2002, Foster.etal:2007,
  Chen.etal:2011}).

Herein we adopt the classical definition of material instability as
the loss of the \emph{strong ellipticity condition}, which is
equivalent to the loss of the \emph{strong Legendre-Hadamard
  condition} for stored energy densities that are twice continuously
differentiable \citep{Antman:2005} and has been associated with the
existence of discontinuous acceleration propagating waves by
\citet{Hill:1962}. We will use the term \emph{acoustic tensor} or
\emph{localization tensor} interchangeably for the second-order tensor
associated with the strong ellipticity condition.

\subsection{Previous Work}

Extensive work has been done on the subject of material instabilities.
The basic theoretical principles follow from the seminal work of
\citet{Hadamard:1903} on elastic stability and were later extended to
the inelastic regime by \citet{Thomas:1961}, \citet{Hill:1962} and
others. The work of \citet{Rice:1976} and \citet{Rudnicki.Riche:1975},
among others, tied the instability in the constitutive description of
homogeneous deformation to the onset of localized deformation, which
was linked to the loss of the positive definiteness of the acoustic or
localization tensor of the material at a given state. See also
\citet*{Armero.Garikipati:1996} and \citet*{Miehe.etal:2004} for a
brief historical overview of the development of classical localization
analysis.

In the context of finite element analysis, existing approaches to
detect material instability as well as the bifurcation directions
generally fall into two categories: analytical and numerical
approaches.

For certain material models under specific loading conditions,
analytical solutions of the instability problem can be derived. For
instance, \citet{Oliver.Huespe:2004} provided closed-form solutions
for the detection of singularity of the localization tensor for a wide
class of small deformation isotropic and anisotropic damage models. On
the basis of the general Hadamard instability criterion,
\citet{Xue.Belytschko:2010} derived a closed-form expression to
determine the onset of instability and the bifurcation directions for
a particular damage plasticity model. These analytical approaches are
computationally very efficient, robust and avoid the pitfall of the
inability to find true global minima \cite{Oliver.etal:2010}.
Closed-form solutions, however, are not available for more complicated
material models under general loading conditions, which motivates the
development and implementation of numerical approaches
\cite{Mosler:2005}.

Among the works that address the numerical resolution of material
instability are those of Ortiz and coworkers \cite{Ortiz:1987,
  Ortiz.etal:1987}.  \citet{Ortiz.etal:1987} formulated the detection
of instability as a constrained minimization problem. A two-step
procedure is proposed, wherein a sweep is performed over the
parametric space of possible bifurcation directions followed by an
iterative solution scheme using a Lagrange multiplier to enforce the
unit-vector constraint. The algorithm was applied to the bifurcation
analysis of a small deformation, isotropic elastoplastic material
model.  \citet{Mosler:2005} proposed a numerical algorithm based on a
sweep over a discrete parametric space and using the result of this
sweep as an initial guess for a Newton method to find a better
approximation to the exact minimum of the determinant of the acoustic
tensor and corresponding bifurcation directions. More recently,
\citet{Oliver.etal:2010} developed a new efficient algorithm based on
the iterative solution of a coupled eigenvalue problem in terms of the
localization tensor. The algorithm is very efficient and accurate for
symmetric cases, where the material tangent has both major and minor
symmetries. For cases that lack minor symmetries, however, the
algorithm only gives an approximation, which limits its applicability
to finite deformation material models, or non-associative plasticity
material models. \citet{Boussaa-Aravas:2001} proposed an alternative
approach where numerical and symbolic computations were combined to
detect the loss of strong ellipticity and applied this approach to a
Gurson-type porous material.

Compared to analytical approaches, numerical algorithms are more
general in the sense that they can be applied to different material
models under different loading conditions, for both 2D and 3D
problems. The drawbacks are also clear, however: they are much more
computationally demanding and less robust. The convergence of an
iterative method is sensitive to the initial guess, for instance. In
the context of a non-linear finite element analysis, the material
instability condition has to be checked at every integration point and
at every time step, and therefore the computational efficiency and
robustness of any numerical algorithm used for its detection become
major concerns.

In this work, we use a sweep-based algorithm followed by a Newton
iterative method to solve the minimization problem associated with the
strong ellipticity condition for the detection of material
instability. We present several parametrizations for the
representation of the unit normal vector used to construct the
acoustic tensor. The hypothesis is that the parametrization of this
normal vector significantly affects the computational cost and
robustness of the numerical solution algorithm. To this end, we
propose a new Cartesian parametrization to construct the acoustic
tensor and compare its performance and robustness against other common
and uncommon parametrizations. The numerical algorithms developed in
this work are general and can be applied to both small and finite
deformation material models with symmetric or unsymmetric tangents.

\section{General Framework}

The determination of the loss of the strong ellipticity condition for
a very general class of materials can be achieved by recourse to
incremental variational constitutive updates. Within this framework,
an incremental stress potential embodies the constitutive behavior of
the material during a time increment, including elasticity,
viscoelasticity, viscoplasticity, and rate dependence
\citep{Ortiz.Stainier:1999, Lambrecht.etal:2003,
  Miehe.etal:2004, Weinberg.etal:2006,
  Fancello.etal:2006, Mosler.Bruhns:2010,
  Bleier.Mosler:2012}.

\subsection{Variational Constitutive Updates}

The mechanical response of the solids considered here is characterized
by a dissipation potential of the form
\begin{equation} \label{eq:power-density}
  D(~F, \dot{~F}, ~Z, \dot{~Z})
  :=
  \dot{A}(~F, ~Z)
  +
  \phi(~F, \dot{~F}, ~Z)
  +
  \psi^*(~Z, \dot{~Z}),
\end{equation}
in which $A(~F, ~Z)$ is the Helmholtz free-energy density,
$\phi(~F, \dot{~F}, ~Z)$ is a viscous potential, $\psi^*(~Z,
\dot{~Z})$ is a dual kinetic potential or dissipation function, $~F$
is the deformation gradient and $~Z$ is a collection of suitable
internal variables that describe the state of the material at a given
point. The first Piola-Kirchhoff stress and the conjugate
thermodynamic forces to $~Z$ are given by
\begin{equation} \label{eq:1PKstress-and-Y}
  ~P
  :=
  \frac{\partial D}{\partial \dot{~F}}(~F, \dot{~F}, ~Z, \dot{~Z})
  =
  \frac{\partial A}{\partial ~F}(~F, ~Z)
  +
  \frac{\partial \phi}{\partial \dot{~F}}(~F, \dot{~F}, ~Z),
  \quad
  ~Y := - \frac{\partial A}{\partial ~Z} (~F, ~Z),
\end{equation}
respectively. In order to ensure a variational structure, we have
postulated the existence of a dual kinetic potential or dissipation
function $\psi^*(~Z, \dot{~Z})$ such that
\begin{equation} \label{eq:dual-kinetic-potential}
  ~Y = \frac{\partial \psi^*}{\partial \dot{~Z}} (~Z, \dot{~Z}).
\end{equation}
Next, we minimize the dissipation potential \eref{eq:power-density}
with respect to the internal variable rates as
\begin{equation}
  \begin{split}
    \inf_{\dot{~Z}} [ D(~F, \dot{~F}, ~Z, \dot{~Z}) ]
    =
    &
    \inf_{\dot{~Z}}
    \left[
      \dot{A}(~F, ~Z)
      +
      \psi^*(~Z, \dot{~Z})
    \right] +
    \phi(~F, \dot{~F}, ~Z),
    \\
    =
    &
    \inf_{\dot{~Z}}
    \left[
      \frac{\partial A}{\partial ~F}(~F, ~Z) : \dot{~F}
      +
      \frac{\partial A}{\partial ~Z}(~F, ~Z) \cdot \dot{~Z}
      +
      \psi^*(~Z, \dot{~Z})
    \right] +
    \phi(~F, \dot{~F}, ~Z),
  \end{split}
\end{equation}
which in turn leads to Biot's equation for standard dissipative systems
\begin{equation} \label{eq:Biots-equation}
  \frac{\partial A}{\partial ~Z} (~F, ~Z)
  +
  \frac{\partial \psi^*}{\partial \dot{~Z}} (~Z, \dot{~Z})
  =
  ~0.
\end{equation}
This is equivalent to state that the internal variables should not
produce any net work, \ie
\begin{equation} \label{eq:internal-no-work}
  \left[
    \frac{\partial A}{\partial ~Z} (~F, ~Z)
    +
    \frac{\partial \psi^*}{\partial \dot{~Z}} (~Z, \dot{~Z})
  \right]
  \cdot
   \dot{~Z}
  =
  0
  \quad
  \forall \dot{~Z}.
\end{equation}

Approximate solutions to \eref{eq:Biots-equation} may be found by
recourse to the incremental energy density function for a time
increment $t \in [t_n, t_{n+1}]$
\begin{equation} \label{incremental-energy-density}
  w(~F_{n+1}, ~Z_{n+1}) :=
  \int_{t_n}^{t_{n+1}}
  \left[
    \dot{A}(~F, ~Z)
    +
    \phi(~F, \dot{~F}, ~Z)
    +
    \psi^*(~Z, \dot{~Z})
  \right]
  \, dt,
\end{equation}
in which the integral is evaluated using a midpoint-like rule
as follows
\begin{equation} \label{incremental-energy-density-mid-point}
  \begin{split}
    w(~F_{n+1}, ~Z_{n+1}) \approx
    &
    A(~F_{n+1}, ~Z_{n+1}) - A(~F_n, ~Z_n) +
    \\
    &
    \triangle t
    \left[
      \phi
      \left(
        ~F_{n+\alpha}, \frac{\triangle ~F}{\triangle t}, ~Z_{n+\alpha}
      \right)
      +
      \psi^*
      \left(
        ~Z_{n+\alpha}, \frac{\triangle ~Z}{\triangle t}
      \right)
    \right].
  \end{split}
\end{equation}
with
\begin{equation} \label{eq:increments}
  \triangle t := t_{n+1} - t_n,
  \quad
  \triangle ~F := ~F_{n+1} ~F_n^{-1},
  \quad
  \triangle ~Z := ~Z_{n+1} - ~Z_n,
\end{equation}
and
\begin{equation} \label{eq:mid-values}
  \begin{split}
    ~F_{n+\alpha} & := \exp[(1 - \alpha) \log ~F_n + \alpha \log ~F_{n+1}],
    \\
    ~Z_{n+\alpha} & := (1 - \alpha) ~Z_n + \alpha ~Z_{n+1},
  \end{split}
\end{equation}
where $\alpha$ is an algorithmic parameter. In order to obtain an
explicit scheme, we choose $\alpha = 0$. Next, we define the
incremental stress potential as
\begin{equation} \label{eq:incremental-stress-potential}
  \begin{split}
    W(~F_{n+1})
    :=
    &
    \inf_{~Z_{n+1}}[w(~F_{n+1}, ~Z_{n+1})]
    \\
    =
    &
    \inf_{~Z_{n+1}}
    \left[
      A(~F_{n+1}, ~Z_{n+1}) - A(~F_n, ~Z_n)
      +
      \triangle t
      \psi^*\left(~Z_n, \frac{\triangle ~Z}{\triangle t}\right)
    \right]
    +
    \\
    &
    \triangle t
    \phi\left(~F_n, \frac{\triangle ~F}{\triangle t}, ~Z_n\right).
  \end{split}
\end{equation}
This minimization provides an optimal path for the internal variables
$~Z$ in the time increment $t \in [t_n, t_{n+1}]$. Furthermore, the
Euler-Lagrange equation corresponding to
\eref{eq:incremental-stress-potential} is
\begin{equation} \label{eq:Biots-equation-discrete}
  \frac{\partial A}{\partial ~Z_{n+1}}(~F_{n+1}, ~Z_{n+1})
  +
  \triangle t
  \frac{\partial \psi^*}{\partial ~Z_{n+1}}
  \left(~Z_n, \frac{\triangle ~Z}{\triangle t}\right)
  =
  ~0.
\end{equation}
which is a discrete version of Biot's equation
\eref{eq:Biots-equation} \citep{Miehe.etal:2002}. The
incremental first Piola-Kirchhoff stress and tangent moduli can be
computed in turn as
\begin{equation} \label{eq:incremental-stress-moduli}
  ~P_{n+1} := \frac{\partial W}{\partial ~F} (~F_{n+1}),
  \quad
  \bbC_{n+1} := \frac{\partial^2 W}{\partial ~F^2} (~F_{n+1}),
\end{equation}
respectively. Thus, by using variational constitutive updates, the
stress and the tangent moduli can be derived from the
hyperleastic-like potential \eref{eq:incremental-stress-potential} for
a very general class of constitutive behavior that may include
viscosity and rate dependence. This in turn provides the means to
apply the classical analysis tools that are used in hyperelasticity,
such as the strong ellipticity condition, for complex inelastic
materials as well.

\subsection{The Strong Ellipticity Condition}

For simplicity in notation and unless otherwise stated, henceforth we
omit the time indices $n$ and $n+1$ with the understating that further
developments take place at time $t_{n+1}$.  The ellipticity condition
can be expressed as
\begin{equation} \label{eq:strong-ellipticity}
  (~m \otimes ~n) : \bbC : (~m \otimes ~n) \ge 0,
  \quad
  \forall \, ~m, ~n \in {"R}^3.
\end{equation}
If the condition holds strictly for non-zero vectors $~m$ and $~n$,
then it is called the strong ellipticity condition
\citep{Hadamard:1903, Truesdell.Noll:2004, Miehe.etal:2004}. It is
customary to \emph{assume} that $~m$ and $~n$ are unit vectors, \ie
$~m, ~n \in S^2$ where $S^2 := \{ ~t \in {"R}^3 \, | \, \| ~t \| =
1\}$ is the unit sphere. Define the acoustic tensor as
\begin{equation} \label{eq:acoustic-tensor}
  ~A := ~n \cdot \bbC \cdot ~n
  \quad \text{or} \quad
  A_{ik} \, ~e_i \otimes ~e_k := n_j C_{ijkl} n_l \, ~e_i \otimes ~e_k,
  \quad
  ~n \in S^2,
\end{equation}
then the strong ellipticity condition becomes
\begin{equation} \label{eq:acoustic-ellipticity}
  ~m \cdot ~A \cdot ~m > 0, \quad ~m \in S^2.
\end{equation}

In order to satisfy the strong ellipticity condition, the acoustic
tensor must be positive definite. Therefore,
\eref{eq:strong-ellipticity} and \eref{eq:acoustic-ellipticity} reduce
to
\begin{equation} \label{eq:acoustic-determinant}
  \det ~A > 0,
\end{equation}
which provides a method to determine the onset of a material
instability.

\subsection{Bifurcation}

By using the strong ellipticity condition
\eref{eq:strong-ellipticity} or its equivalent with the acoustic
tensor \eref{eq:acoustic-determinant}, the detection of bifurcation
or loss of ellipticity in the material is fully characterized by its
fourth-order tangent moduli \eref{eq:incremental-stress-moduli}. The
onset of bifurcation is then posed as a minimization problem.  First
we assume that the normal vector $~n$ is parametrized by a set of
parameters $~q$, thus turning the determinant of the acoustic tensor
$\det ~A$ into a function of $~q$.  Then the determinant of the
acoustic tensor $\det ~A(~q)$ is minimized with respect to
$~q$. Thus the loss of strong ellipticity may be stated as
\begin{equation} \label{eq:minimization-determinant}
  f(~q) := \det ~A(~q),
  \quad
  \min_{~q} f(~q) = 0,
  \quad
  ~n(~q) \in S^2.
\end{equation}

If the determinant function $f(~q)$ is differentiable, the
minimization problem can be rewritten equivalently as
\begin{equation}\label{eq:minimization-derivative}
  \frac{\partial f}{\partial ~q}(~q) = ~0,
\end{equation}
which can be solved by standard numerical optimization techniques, \eg
a Newton-type iterative procedure.

\section{Parametrizations for Bifurcation Analysis}
\label{sec:parametrizations}

Efficient computation of the minimization problem
\eref{eq:minimization-derivative} requires a careful choice of the
parametrization for the normal vector $~n(~q) \in S^2$, which is
equivalent to select a parametrization for the unit sphere. This
choice has a significant effect on the complexity of the determinant
function $f(~q)$ and its derivatives with respect to $~q$ needed to
solve the optimization problem. Herein, five different options are
explored. The first four (spherical, stereographic, projective,
tangent) are indeed parametrizations of the unit sphere.  The last
parametrization, which we term Cartesian, relaxes the restriction that
the normal vector be an element of the unit sphere. We describe the
parametrizations in detail next, assuming that a Cartesian frame of
reference originates from the center of each one.

\subsection{Spherical Parametrization}
\label{subsec:spherical}

This parametrization is the most commonly used in numerical
bifurcation analysis, \eg \cite{Mosler:2005, Regueiro.Foster:2011}.
In the spherical parametrization, elements $~n$ of the unit sphere
$S^2$ are simply parametrized by their spherical coordinates with
polar angle $\varphi \in [0, \pi]$, azimuthal angle $\theta \in [0,
  \pi]$ and radial distance $r = \|~n \| = 1$. The reduced range in
the angle $\theta$ is due to symmetry of the bifurcation condition, as
for this purpose $~n$ and $- ~n$ will yield the same result, see
\fref{fig:spherical}. In terms of the canonical basis
\begin{equation}
  ~n(\varphi, \theta)
  :=
  \begin{Bmatrix}
    \sin\varphi \sin\theta
    \\
    \cos\varphi
    \\
    \sin\varphi \cos\theta
  \end{Bmatrix}.
\end{equation}

\subsection{Stereographic Parametrization}
\label{subsec:stereographic}

The unit sphere is parametrized with the aid of an equatorial plane as
shown in \fref{fig:stereographic}.  Consider a point $P$ that is both
on this plane and on a line that passes through the north pole $Q$ of
the sphere and the tip of the vector $~n$. The Cartesian coordinates
$x$ and $y$ of $P$ provide the desired parametrization, which can be
easily derived by finding the intersection of the line and the
sphere. The upper hemisphere can be ignored due to the symmetry of the
bifurcation condition, thus avoiding the singularity in parametrizing
a normal vector that points to the north pole $Q$. The normal vector
$~n$ in terms of the canonical basis is
\begin{equation}
  ~n(x,y)
  :=
  \begin{Bmatrix}
    \frac{\displaystyle 2x}{\displaystyle x^2+y^2+1}
    \\[0.9em]
    \frac{\displaystyle 2y}{\displaystyle x^2+y^2+1}
    \\[0.9em]
    \frac{\displaystyle x^2+y^2-1}{\displaystyle x^2+y^2+1}
  \end{Bmatrix}.
\end{equation}
where the parameters $x \in [-1, 1]$ and $y \in [-1, 1]$.

\subsection{Projective Parametrization}
\label{subsec:projective}

In the projective parametrization, the norm of the position vector of
a point $P$ with respect to the center of the sphere is constrained to
obtain a unit vector $~n$ \citep{Ortiz.etal:1987}. This is
equivalent to project the point $P$ onto the unit sphere $S^2$, as
shown in \fref{fig:projective}. The normalization is effected
by means of a constraint enforced by a Lagrange multiplier as
\begin{equation}
  ~n(x,y,z)
  :=
  \begin{Bmatrix}
    x
    \\
    y
    \\
    z
  \end{Bmatrix},
  \quad
  \text{subjected to } x^2+y^2+z^2 = 1.
\end{equation}
where the parameters $x \in [-1, 1]$, $y \in [-1, 1]$
and $z \in [-1, 1]$.

\subsection{Tangent Parametrization}
\label{subsec:tangent}

This parametrization of the unit sphere is defined by a tangent plane
\citep{Simo.Fox:1989}. Let $~u\in {"R}^3$ be the position vector of
the point $P$ in the tangent plane with respect to the contact point
$Q$ between the sphere and the plane, then let $~e \in S^2$ be the
position vector of the contact point $Q$ with respect to the center of
the sphere $O$, as shown in \fref{fig:tangent}. Define a rotation
vector $\btheta := ~e \times ~u$, then the rotation angle is $\theta
:= \| \btheta \| \equiv \| ~u \|$. Let also $\check{\btheta} \in
so(3)$ be the skew-symmetric tensor such that $\check{\btheta} \cdot
~v \equiv \btheta \times ~v \ \forall \ ~v \in {"R}^3$. The expression
for the exponential map for $\check{\btheta}$ is
\begin{equation}
  \exp \check{\btheta}
  :=
  \begin{cases}
    ~I \in SO(3),
    &
    \text{ if }\theta = 0;
    \\
    \displaystyle{
      ~I + \frac{\sin \theta}{\theta} \check{\btheta} +
      \frac{(1 - \cos \theta)}{\theta^2} \check{\btheta}^2 \in SO(3),
    }
    &
    \text{ if }\theta > 0;
  \end{cases}
  \label{eq:Rodrigues-formula}
\end{equation}
which is often accredited to Rodrigues \citep{Gallier:2011}. Next
define
\begin{equation}
  \exp_{~e} ~u
  :=
  \exp \check{\btheta} \cdot ~e
  =
  \cos \theta ~e + \frac{\sin \theta}{\theta}
  ~u \in S^2.
\end{equation}
The parametrization follows immediately by setting the contact point
$Q$ to the north pole of the sphere, \ie $~e = [0,0,1]^T$ and $~u =
[x,y,0]^T$ with the normal vector $~n$ given by
\begin{equation}
  ~n
  =
  \exp_{~e} ~u \in S^2.
\end{equation}
which leads to a more explicit representation for the normal vector in
the canonical basis as
\begin{equation}
  ~n(x,y)
  :=
  \begin{Bmatrix}
    \frac{\displaystyle x \sin \sqrt{x^2+y^2}}{\displaystyle \sqrt{x^2+y^2}}
    \\[0.9em]
    \frac{\displaystyle y \sin \sqrt{x^2+y^2}}{\displaystyle \sqrt{x^2+y^2}}
    \\[0.9em]
    \cos \sqrt{x^2+y^2}
  \end{Bmatrix}.
\end{equation}
where the parameters $x \in [-\pi / 2, \pi / 2]$ and
$y \in [-\pi / 2, \pi / 2]$

\subsection{Cartesian Parametrization}
\label{subsec:Cartesian}

The previous four are parametrizations of the unit sphere. Here, we
propose a new parametrization, termed Cartesian, where the restriction
that the normal vector be of unit length is relaxed.  To set the stage
for the Cartesian parametrization, we revisit the strong ellipticity
condition
\begin{equation}
  (~u \otimes ~v) : \bbC : (~u \otimes ~v) > 0,
  \quad
  \forall \, ~u, ~v \in {"R}^3 \setminus \{~0\}
\end{equation}

Note that this condition only requires that the vectors $~u$ and $~v
$ be non-zero. Thus, the condition that they belong to the unit sphere
$S^2$ may be relaxed. In analogy to the classical acoustic tensor
\eref{eq:acoustic-tensor}, define
\begin{equation} \label{eq:Cartesian-acoustic-tensor}
  ~B := ~v \cdot \bbC \cdot ~v
  \quad \text{or} \quad
  B_{ik} \, ~e_i \otimes ~e_j := v_j C_{ijkl} v_l  \, ~e_i \otimes ~e_j,
  \quad
  ~v \in {"R}^3 \setminus \{~0\},
\end{equation}
thus the strong ellipticity condition may be expressed as
\begin{equation} \label{eq:Cartesian-acoustic-ellipticity}
  ~u \cdot ~B \cdot ~u > 0,
  \quad
  ~u \in {"R}^3 \setminus \{~0\}.
\end{equation}

As in \eref{eq:acoustic-determinant}, the strong ellipticity
condition becomes
\begin{equation} \label{Cartesian-acoustic-determinant}
  \det ~B > 0.
\end{equation}

\begin{proposition}
  The tensor $~B$ from \eref{eq:Cartesian-acoustic-tensor} leads to
  the same bifurcation condition than the acoustic tensor $~A$ from
  \eref{eq:acoustic-tensor}.
\end{proposition}

\begin{proof}
  Introduce the bijective map $g : {"R}^3 \setminus \{~0\}
  \mapsto S^2 \times {"R}^+$ that allows the representation of
  nonzero vectors in ${"R}^3$ as unit vectors in the unit sphere
  (direction) and the corresponding nonzero norm (magnitude). Then
  define
  \begin{equation}
    ~v \in {"R}^3 \setminus \{~0\},
    \quad
    v := \| ~v \| \in {"R}^+,
    \quad
    ~n := \frac{~v}{v} \in S^2,
  \end{equation}
  therefore from \eref{eq:acoustic-ellipticity} and
  \eref{eq:Cartesian-acoustic-ellipticity}
  \begin{equation} \label{eq:Cartesian-from-acoustic}
      ~B(v, ~n)
      =
      v^2 ~A(~n)
      \quad \text{and} \quad
      \det ~B(v, ~n) = v^6 \det ~A(~n).
  \end{equation}

  Now let the bifurcation condition for $~A$ be
  \begin{equation}
    \min_{~n} \det ~A(~n) = 0,
    \quad
    ~a := \arg \min_{~n} \det ~A(~n) \in S^2
    \implies
    \det ~A(~n) > 0 \, \forall \, ~n \neq ~a,
  \end{equation}
  then it follows from \eref{eq:Cartesian-from-acoustic} that
  \begin{equation}
    \det ~B(s, ~a) = 0,
    \quad
    \det ~B(s, ~n) > 0,
    \quad \forall \, ~n \neq ~a
    \text{ and } \forall \, s \in {"R}^+,
  \end{equation}
  which means that
  \begin{equation}
    \min_{v, ~n} \det ~B(v, ~n) = 0,
    \quad
    \{s, ~a\} := \arg \min_{v, ~n} \det ~B(v, ~n)
    \,
    \forall \, s \in {"R}^+,
  \end{equation}
  as required.
\end{proof}

In order to remove the multiple minima associated with the arbitrary
value of the scalar parameter $s$ and obtain a parametrization, we
restrict the range of the Cartesian coordinates such that
$||~v||_{\infty} = 1$ and set the normal vector to
\begin{equation}
  ~v(x,y,z)
  :=
  \begin{cases}
    [x,y,1]^T,
    &
    \text{ if }x \in [-1,1] \text{ and } y \in [-1,1);
    \\
    [1,y,z]^T,
    &
    \text{ if }y \in [-1,1] \text{ and } z \in [-1,1);
    \\
    [x,1,z]^T,
    &
    \text{ if }z \in [-1,1] \text{ and } x \in [-1,1);
    \\
    [1,1,1]^T,
    &
    \text{ otherwise }.
  \end{cases}
\end{equation}

This confines the normal vector to the cube of side length $2$
centered at the origin as shown in \fref{fig:Cartesian}. Only three
faces of the cube need to be considered due to the symmetry of the
bifurcation condition.

\begin{figure}[htbp]
  \begin{center}
    \unitlength=1.0mm
    \subfigure[Spherical]{
      \includegraphics[width=67mm]{figs/spherical.pdf}
      \label{fig:spherical}
    }
    \subfigure[Stereographic]{
      \includegraphics[width=67mm]{figs/stereographic.pdf}
      \label{fig:stereographic}
    }
    \subfigure[Projective]{
      \includegraphics[width=67mm]{figs/projective.pdf}
      \label{fig:projective}
    }
    \subfigure[Tangent]{
      \includegraphics[width=67mm]{figs/tangent.pdf}
      \label{fig:tangent}
    }
    \subfigure[Cartesian]{
      \includegraphics[width=67mm]{figs/cartesian.pdf}
      \label{fig:Cartesian}
    }
    \caption{Parametrizations.}
    \label{fig:parametrizations}
  \end{center}
\end{figure}

\section{Bifurcation Detection}
\label{sec:detection}

Within an incremental update setting, the numerical detection of the
bifurcation condition for each time increment using any of the
parametrizations just described consists of the following two steps:

\begin{itemize}

\item An initial sampling is performed over the
parametric space for $~q$ for the normal vector $~n \in S^2$ or $~v
\in {"R}^3 \setminus \{~0\}$ associated with the
parametrization. This leads to a rough estimate of minimum of the
determinant function \eqref{eq:minimization-determinant} and the
associated bifurcation directions.

\item The coarse estimate can be used to initiate an iterative
procedure to find a more accurate estimate of the onset of bifurcation
and its associated directions by solving the optimization problem in \eqref{eq:minimization-derivative}.

\end{itemize}

In an actual finite element simulation, the above two-step procedure
may not yield estimates of the bifurcation condition that are accurate
enough due to finite time increment. One way to improve the solution
is to introduce adaptive time increments. Define

\begin{equation} \label{eq:general-minimization-problem}
  \mu_n := \min_{~q} f_n(~q) = \min_{~q} \det ~B_n(~q)
\end{equation}

where the tensor $~B_n(~q)$ may be either the one from
\eref{eq:acoustic-tensor} or the one from
\eref{eq:Cartesian-acoustic-tensor}, depending on the parametrization
in use, and the index $n$ indicates that the evaluation occurs at time
$t_n$.

Consider the original time increment from $t_n$ to $t_{n+1}$, where
$\mu_n > 0$ and $\mu_{n+1} < 0$. This means that between time $t_n$
and $t_{n+1}$, the strong ellipticity condition is violated and hence
material bifurcates. Assume also that $\mu_n / \mu_0 > \epsilon$,
where $\mu_0$ is the value of the determinant function evaluated at
time $t_0$ and $\epsilon$ is a target tolerance. We wish to find a
better estimate for the determinant function $\mu_n$, and hence the
bifurcation time $t_n$, such that $\mu_n / \mu_0 \le \epsilon$. This
is achieved by an adaptive time increment procedure by means of
bisection, as shown in Algorithm~\ref{alg:adaptive-step}. This
algorithm repeatedly cut the time increment to half until the
convergence criteria $\mu_n / \mu_0 \le \epsilon$ is met.

\begin{algorithm}
  \caption{$\text{AdaptiveStep}(\mu_0, \mu_{n+1}, t_{n+1}, \epsilon)$}
  \begin{algorithmic}
    \REQUIRE $\mu_{n+1} < 0$
    \ENSURE $\mu_{n+1,k} \in [0, \epsilon \mu_0]$
    \STATE initialize
    $k \leftarrow 1,
    \quad
    \alpha \leftarrow \frac{1}{2},
    \quad
    \triangle t \leftarrow t_{n+1} - t_n,
    \quad
    \mu_{n+1,k} \leftarrow \mu_{n+1}$
    \WHILE{ $\mu_{n+1,k} < 0$ {  or  } $ \mu_{n+1,k} / \mu_0
      > \epsilon$ }
    \STATE $t_{n+1,k} \leftarrow t_n + \alpha \triangle t$
    \STATE compute $~F(t_{n+1,k})$ using the global solution scheme
    \STATE compute $\triangle ~Z(t_{n+1,k})$
    by solving \eref{eq:Biots-equation-discrete}
    \STATE compute $\bbC(t_{n+1,k})$
    using \eref{eq:incremental-stress-moduli}
    \STATE compute $\mu_{n+1,k}$
    by solving \eref{eq:general-minimization-problem}
    \IF{$\mu_{n+1,k} > 0$}
    \STATE $\alpha \leftarrow \alpha + 2^{-k}$
    \ELSE
    \STATE $\alpha \leftarrow \alpha - 2^{-k}$
    \ENDIF
    \STATE $k \leftarrow k+1$
    \ENDWHILE
  \end{algorithmic}
  \label{alg:adaptive-step}
\end{algorithm}

The adaptive time increment procedure allows the accurate (up to the
tolerance $\epsilon$) detection of bifurcation time during a loading
process. The procedure described in this section to numerically detect
material bifurcation can be applied to a very general class of
materials and will be analyzed in the following section.

\section{Numerical Examples}
\label{sec:numerical-examples}

The performance and applicability of the proposed Cartesian along with
other existing common and uncommon parametrizations are examined by
applying them to the bifurcation analysis of several material models
under different loading conditions. The analysis is performed at the
material point level. Of particular interest are the robustness and
computational efficiency of different parametrizations.

\subsection{Small deformation isotropic elastic damage model}
\label{subsec:isotropic}

We start the bifurcation analysis on a simple small deformation
isotropic damage model. The model formulation is briefly presented
first. Then, a simple shear test will be performed to study the
performance of different parametrizations on the detection of material
bifurcation.

\subsubsection{Model formulation}

The stress and constitutive tangent of the small deformation isotropic
damage model will be derived from a strain-energy function, which is
assumed to have the following form:

\begin{equation}\label{eq:iso_psi}
 \Psi(\bepsilon ^e, \xi)
   = \frac{1}{2} (1 - \xi)
     \bepsilon ^e : \mathbb{C}^e : \bepsilon ^e
\end{equation}

where $\bepsilon^e$ is the infinitesimal elastic strain tensor,
$\mathbb{C}^e$ is the fourth-order elastic modulus, and $\xi$
is a damage parameter introduced to trigger material bifurcation. For
isotropic linear elasticity, the elastic modulus $\mathbb{C}^e$ is
given as

\begin{equation}
  \mathbb{C}^e = \lambda \bdelta\otimes\delta + 2\mu~I
\end{equation}

where $\lambda$ and $\mu$ are Lam\'{e} constant and shear modulus,
respectively. $\bdelta$ is the second-order identity tensor,
$(~I)_{ijkl} = 1/2(\delta_{ik}\delta_{jl} +
\delta_{il}\delta_{jk})$ is the fourth-order symmetric identity
tensor.

We adopt the following evolution law for the scalar damage parameter $
\xi$ \cite{Holzapfel:2000}

\begin{equation}\label{eq:iso_xi}
  \xi(\alpha) = \xi_{\infty} [ 1- {\rm exp}(-\alpha / \tau)]
\end{equation}

where $\xi_{\infty}$ describes the dimensionless maximum damage and
$\tau$ is referred to as the damage saturation parameter. The
parameter $\alpha$ is the maximum thermodynamic force
\cite{Holzapfel:2000} with the same dimension as the effective strain
energy. Within the closed time interval $[0,t]$, $\alpha$ is given as

\begin{equation}\label{eq:alpha}
  \alpha(t) = \max_{s\in [0,t]}\Psi_0(s)
\end{equation}

where $\Psi_0(s)$ is the undamaged strain energy at time $s$.
$s \in [0,t]$ denotes the history variable.

Given the strain-energy function \eref{eq:iso_psi} and the damage
evolution \eref{eq:iso_xi}, the fourth-order tangent modulus can be
derived by taking 2nd derivative of the strain-energy function with
respect to the strain measure $\bepsilon_e$, which results in

\begin{equation}
  \mathbb{C} = (1-\xi)\mathbb{C}^e
    - \beta \frac{\partial\xi}{\partial\alpha}
    (\bsigma_0\otimes\bsigma_0)
\end{equation}

where $\bsigma_0$ is the effective (undamaged) Cauchy stress.
$\beta = 1$ if damage evolves within the time increment and $\beta=0$
otherwise. This tangent modulus will be used to compute the acoustic
tensor \eref{eq:acoustic-tensor}, which will then be checked for
material bifurcation.

\subsubsection{Simple shear test}

In this section, a simple shear test is simulated, where the following
material properties are used: $\lambda = 80$, $\mu = 80$,
$\xi_{\infty} = 1.0$ and $\tau = 1.0$. The resulting shear stress vs.
shear strain is plotted in Figure~\ref{fig:iso_stress_strain}(a). The
softening response is due to the evolution of the introduced damage
parameter $\xi$.

For the numerical detection of material bifurcation, the two-step
procedure described in Section \ref{sec:detection} is adopted, i.e.,
(1) an initial sampling performed over the parametric space, and (2) a
Newton iterative procedure for better estimate of the onset of
bifurcation and its associated directions. Figure~
\ref{fig:iso_stress_strain}(b) shows the degradation of the
determinant function (det$~A$) for all five parametrizations upto the
point material bifurcation is detected. When det$~A = 0$, the
material bifurcates. In this example, all five parametrizations detect
bifurcation at the same time, i.e., when the shear strain
$\epsilon_{12}=0.0559$ as marked in Figure~
\ref{fig:iso_stress_strain} (a). With the adaptive time step
algorithm, the precise time (upto the set tolerance) of bifurcation
can be detected.

\begin{figure}[H]
  \centering \subfigure[]{
    \includegraphics[width=0.45\textwidth]
    {figs/iso_shear_stress_strain.pdf}
  } \subfigure[]{
    \includegraphics[width=0.45\textwidth]
    {figs/iso_shear_mindetA_strain.pdf}
  }
  \caption{Simple shear test on small deformation
  isotropic damage model:
  (a)stress strain behavior, with the cross indicating bifurcation, and
  (b) degradation of det$~A$ for different
  parametrizations upto the point material bifurcation is detected ($\epsilon_{12}=0.0559$).}
  \label{fig:iso_stress_strain}
\end{figure}

While all five parametrizations detect bifurcation at the same time,
Figure~\ref{fig:iso_stress_strain}(b) provides little information on
their computational efficiency and robustness, which are the focus of
this work. The computational cost of bifurcation detection mainly
consists of two parts: (1) the time for the initial sampling over the
parametric space, and (2) the time for the Newton iterative solve.

The time for the initial sampling depends on the number of sampling
points, or equivalently, the density of the initial sampling grid. The
denser the initial sampling grid is, the more expensive it is
computationally to perform the sweep. The time for the Newton
iterative solve, on the other hand, depends mainly on the complexity
of the objective function, i.e., det$~A$, as well as the quality of
the initial guess.

To compare computational costs of different parametrizations, we
record the time spent on bifurcation check at a particular loading
increment, e.g., at the increment leading to bifurcation. We also vary
the density of the initial sampling grid to study its effect on
different parametrizations. A robust parametrization should be
insensitive to the initial sampling grids.

The results on computational cost are summarized in Table~
\ref{tab:iso_shear_runtime}. The density of the initial sampling grid
is represented by the sampling interval and the number of sampling
points. The table only shows the number of sampling points, $N$, along
one dimension of the parametric space. The total number of sampling
points should be $N^{dim}$, where $dim$ is the total dimension of
the parametric space. For instance, for spherical parametrization,
there are two independent parameters, $\varphi$ and $\theta$.
Therefore, $dim=2$ for spherical parametrization.

It can be seen from Table~\ref{tab:iso_shear_runtime}, as the number
of sampling points $N$ per dimension decreases, so does the
computational cost. The spherical and the Cartesian parametrizations
are the most efficient. The stereographic, projective and tangent are
more computationally expensive. In the extreme case with $N=1$,
meaning there is only one initial sampling point per dimension, the
stereographic, projective and tangent fail to correctly detect
bifurcation, shown as `n/a' in the table.

\begin{table}[H]
  \begin{center}
    %\begin{tabular}{ p{1.5cm} | p{1.7cm} p{1.7cm} p{1.7cm} p{1.7cm} p{1.7cm} }
    \begin{tabular}{c c | r r r r r}
      \toprule
      Sampling   & Sampling &   \multicolumn{5}{c}{Run time ($\mu$s)}	\\
      interval     & points ($N$)     &  Spherical    &   Stereographic  &   Projective  &   Tangent   & Cartesian  \\
      \midrule
      0.05      &      41     &    305        &       155       &       5636      &      226       &       347         \\
      0.1        &      21     &    125        &       89         &       884        &      107       &       115         \\
      0.2        &      11     &    85          &       60         &       183        &      64         &       81         \\
      0.3        &      7       &    60          &       184       &       178        &      157       &       39          \\
      0.4        &      5       &    74          &       181       &       197        &      145       &       27          \\
      0.5        &	    5       &    74          &       37         &       88          &      53         &       27          \\
      0.6        &	    3       &    72          &       174       &       200        &      215       &       23          \\
      0.7        &	    3       &    71	      &       180       &       188        &      188       &       23          \\
      0.8        &      3       &    54          &       170       &       188        &      144       &       24          \\
      0.9        &	    3       &    53          &       177       &       156        &      159       &       23          \\
      1.0        &      3	     &    43	      &       37         &       79          &      51         &       23          \\
      1.5        &	    1       &    52	      &       n/a        &       n/a         &      n/a        &       21          \\
      \bottomrule
    \end{tabular}
    \caption{Computational cost of different parametrizations in
    simple shear test at loading increment leading to bifurcation.
    `n/a' means the parametrization fails to detect bifurcation in
    this loading increment.}
    \label{tab:iso_shear_runtime}
  \end{center}
\end{table}

As aforementioned, the choice of parametrization directly affects the
complexity of the objective function ${\rm det}~A$ in
\eref{eq:minimization-derivative}, which in turn affects the
computational efficiency and robustness of different parametrizations
on detection of material bifurcation as shown in
Table~\ref{tab:iso_shear_runtime}. To illustrate this point, the
landscapes of the objective function ${\rm det}~A$ at bifurcation,
i.e., at $\bepsilon_{12}=0.0559$ are plotted in
Figure~\ref{fig:iso_shear_detA}. The corresponding plane views of the
determinant landscapes are shown in
Figure~\ref{fig:iso_shear_detAXplane}, where the white stars indicate
global minimum point(s). The projective parametrization requires three parameters and is not visualized in this work.

\begin{figure}[H]
   \centering \subfigure[Spherical]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_spherical_detA.pdf}
 } \subfigure[Cartesian]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_cartesian_detA.pdf}
 } \subfigure[Stereographic]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_stereographic_detA.pdf}
 } \subfigure[Tangent]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_tangent_detA.pdf}
 }
   \caption{det$~A$ landscapes at bifurcation
   for simple shear test on small deformation isotropic damage model.}
   \label{fig:iso_shear_detA}
 \end{figure}

\begin{figure}[H]
   \centering \subfigure[Spherical]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_spherical_detAXplane.pdf}
 } \subfigure[Cartesian]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_cartesian_detAXplane.pdf}
 } \subfigure[Stereographic]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_stereographic_detAXplane.pdf}
 } \subfigure[Tangent]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_tangent_detAXplane.pdf}
 }
   \caption{Plane views det$~A$ landscapes at bifurcation
   for simple shear test on small deformation isotropic damage model.
   The white stars indicate global minimum point in the landscape.}
   \label{fig:iso_shear_detAXplane}
 \end{figure}

From the landscape plots, it is clear that the complexity of the
determinant function depends greatly on the choices of
parametrization. Even for a very simple small deformation isotropic
model adopted in this example, the landscape of the determinant
function can be quite complex as in the cases of spherical,
stereographic and tangent parametrizations.

The Cartesian parametrization results in a simple `bowl-shaped'
objective function, which makes the Newton-type iterative solve
particularly robust and insensitive to the initial guess. This has
been shown in Table~\ref{tab:iso_shear_runtime} and will be
elaborated further when the initial sweep is eliminated.

To further analyze the robustness of different parametrizations, we
compare their performance when there is no sweep algorithm. To provide
an initial guess for the Newton iterative solve without a sweep
algorithm, an initial point is randomly generated within the
parametric space for each parametrization. The tangent modulus at the
bifurcation step, i.e., when $\epsilon_{12}=0.0559$, is used. If the
parametrization is able to correctly detect the onset of bifurcation
and its associated directions, the parametrization is said to succeed
for this one set of randomly generated parameters. This process is
repeated for 1000 times, i.e., 1000 sets of random initial guess for
each parametrization are generated.

Table~\ref{tab:iso_shear_random_para} shows the percentage of
successful bifurcation detection computed from 1000 runs for all five
parametrizations. The averaged number of iteration and the
computational cost of those successful runs are also recorded and
shown in the table. It can be seen that the proposed Cartesian
parametrization is much more robust than commonly used spherical
parametrization, i.e., $100\%$ vs. $42.5\%$ success rate. Cartesian
also outperforms other uncommon parametrizations. In term of
computational cost, the Cartesian is also efficient with an averaged
run time of $170\mu s$.

\begin{table}[H]
  \begin{center}
    %\begin{tabular}{ lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm}}
    %  \begin{tabular*}{1.0\textwidth}{l | c c c c c}
    \begin{tabular}{l | c c c c c}
      \toprule
       &  Spherical    &   Stereographic   & Projective   &   Tangent   &   Cartesian                 \\
      \midrule
      Success rate ($\%$)                      &    42.7    &    22.7    &    59.9     &    20.6     &   100          \\
      Averaged iteration count               &    12.2    &    4.70    &    8.86     &    5.12     &   5.35          \\
      Averaged run time (${\mu}s$)     &    549     &    242     &    495      &    264      &   207         \\
      \bottomrule
    \end{tabular}
    \caption{Isotropic small deformation model: success rate and computational cost of Newton iterative solve with a single random initial point. A total of 1000 random trials are performed for each parametrization.}
    \label{tab:iso_shear_random_para}
  \end{center}
\end{table}

As aforementioned, the superior performance of the proposed Cartesian
in term of computational efficiency and robustness can be attributed
to its relatively simple determinate function landscape, which makes
the Newton iterative solve easier to converge. Figure~
\ref{fig:iso_shear_robust} shows the contour of the determinant
function used in the above robustness  study. 1000 random initial
points are also plotted. If the initial guess leads to a success
detection of bifurcation and its directions, the point will be marked
as a solid circle ($\bullet$). Otherwise, it will be marked as a cross
($\times$). This figure provides a very direct visualization of the
robustness study results.

\begin{figure}[H]
   \centering \subfigure[Spherical]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_spherical_random.pdf}
 } \subfigure[Cartesian]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_cartesian_random.pdf}
 } \subfigure[Stereographic]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_stereographic_random.pdf}
 } \subfigure[Tangent]{
   \includegraphics[width=0.45\textwidth]
   {figs/iso_shear_tangent_random.pdf}
 }
   \caption{Isotropic small deformation model: results of Newton
   iterative solve with a single random initial point plotted on the
   contour of determinant function at bifurcation. A solid circle
   ($\bullet$) means the initial point leads to a success detection of
   bifurcation and its directions. A cross ($\times$) means the Newton
   iterative solve fails. A total of 1000 random trials are performed
   for each parametrization.}
   \label{fig:iso_shear_robust}
\end{figure}

\subsection{Finite deformation anisotropic hyperelastic damage model}
\label{subsec:anisotropic}

The second material model tested is a finite deformation anisotropic
hyperelastic damage model. By adding complexity to the material model,
and hence the tangent modulus, we would like to study how will the
performance of different parametrizations be affected. As in the
previous example, we first present the key feature of the material
model.

\subsubsection{Model formulation}

The free energy function of the finite-deformation anisotropic
hyperelastic damage model consists of an isotropic term and direction-
dependent terms. This type of energy formulation is motivated to
capture behavior of materials with an isotropic matrix and some
microfibers with preferred directions, such as the model proposed by
\citet{Chen.etal:2014} to capture behavior of hydrided nuclear
cladding materials. We assume that the damage affects both the matrix
and the microfibers. The free energy function is proposed to have the
following form:

\begin{equation}\label{eq:aniso_energy}
  \Psi (~C, ~M, \xi_m, \xi_i)
    = (1-\xi_m) f_m \Psi_m^0(~C)
    + \sum_{i}^{n} (1-\xi_i) f_i \Psi_i^0(~C, ~M)
\end{equation}

where $~C$ is the Right Cauchy-Green tensor, $~M$ is a
unit vector characterizing the preferred fiber direction, $f_m$ and
$f_i$ are the volume fraction of the matrix and $i$th fiber, $n$ is
the number of fiber terms, $\xi_m$ and $\xi_i$ are the damage factors
corresponding to the matrix and the $i$th fibers, respectively. In the
following examples, we assume that there are two preferred fiber
directions, i.e., $n=2$.

We adopt a compressible Neo-Hookean type energy function for the
effective (undamaged) matrix component

\begin{equation}\label{eq:aniso_Psim0}
  \Psi_m^0 (~C)
    = \frac{1}{8}\lambda (\ln I_3)^2
    - \frac{1}{2}\mu \ln I_3
    + \frac{1}{2}\mu( I_1 - 3)
\end{equation}

where $\lambda$ and $\mu$ are Lam\'{e}'s constant and shear modulus,
respectively.

For microfibers, we adopt one particular form of strain-energy
function proposed in \cite{Holzapfel.etal:2010}

\begin{equation}
  \Psi_i^0(~C, ~M)
    = \frac{k_i}{q_i}
    \{ \exp[q_i(I_4 - 1)^2] \}
\end{equation}

where $k_i$ and $q_i$ are elastic constants for the $i$th fiber.
The strain invariants $I_1$, $I_3$ and $I_4$ are defined as

\begin{equation}
  I_1 = \tr ~C,
\end{equation}

\begin{equation}
  I_3 = \det ~C,
\end{equation}

\begin{equation}
  I_4 = ~M \cdot (~C \cdot ~M)
\end{equation}

For the damage parameter, the same evolution law as in
\eref{eq:iso_xi} will be used, except that for each phase of the
material, there will be a different set of parameters \cite{Chen.etal:2014}.

Given the energy function \eref{eq:aniso_energy}, the fourth-order
tangent modulus can be derived by taking derivative of the energy
function with respect to some strain measures, in particular

\begin{equation}\label{eq:aniso_tangent}
  \tilde{\mathbb{C}}
   = (1-\xi_m) \tilde{\mathbb{C}}_m^0
   + \sum_i^n (1-\xi_i) \tilde{\mathbb{C}}_i^0
   -\beta_m \xi_m'  (~S_m^0 \otimes ~S_m^0 )
   - \sum_i^n \beta_i \xi_i' (~S_i^0 \otimes ~S_i^0 )
\end{equation}

where $\beta_m = 1$ if damage of the matrix evolves within the
time increment and $\beta_m=0$ otherwise. $\beta_i = 1$ if damage of
the $i$th fiber evolves within the time increment and $\beta_i=0$
otherwise. $\xi_m'$ and $\xi_i'$ are the derivative of the damage
parameters defined in \eref{eq:iso_xi} with respect to the maximum
thermodynamic force defined in \eref{eq:alpha}. $~S_m^0$ and
$~S_i^0$ are the effective (undamaged) second Piola-Kirchhoff stress for the matrix and the $i$th fibers, given by

\begin{equation}\label{eq:aniso_S0m}
  ~S_m^0 =
    2 f_m \frac{\partial \Psi_m^0}{\partial~C}
\end{equation}

\begin{equation}\label{eq:aniso_S0i}
  ~S_i^0 =
    2 f_i \frac{\partial \Psi_i^0}{\partial~C}
\end{equation}

where $f_m$ and $f_i$ are the volume fraction of the matrix and $i$th fiber, respectively.

The effective tangent modulus tensor can be calculated as

\begin{equation}\label{eq:aniso_tangent1}
  \tilde{\mathbb{C}}_m^0 =
    2 \frac{\partial ~S_m^0}{\partial~C}
\end{equation}

\begin{equation}\label{eq:aniso_tangent2}
  \tilde{\mathbb{C}}_i^0 =
    2 \frac{\partial ~S_m^0}{\partial~C}
\end{equation}

It should be noted that the fourth-order tangent $\tilde{\mathbb{C}}$
from \eref{eq:aniso_tangent} is computed as the derivative of strain
energy with respect to the right Cauchy-Green tensor. The strong
ellipticity condition \eref{eq:strong-ellipticity} requires the
tangent $\mathbb{C}$ to be computed as a derivative with respect to
the deformation gradient. These two tangents can be converted using
the following relation (in indicial notation)

\begin{equation}\label{eq:aniso_tangent3}
  \mathbb{C}_{ijkl} = S_{lj} \delta_{ik}
    + F_{ip} \tilde{\mathbb{C}}_{pjlq} F_{kq}
\end{equation}

where $S_{lj}$ is the second Piola-Kirchhoff stress (including
damage contribution) of the corresponding phase (e.g., matrix or fiber
component), and $\bdelta$ is the Kronecker delta and $~F$ is the
deformation gradient. Note that in \eref{eq:aniso_tangent3}, the
indices in the subscript refer to the individual component of a
tensor, not to confuse with the subscripts `$m$' and `$i$' used in
\eref{eq:aniso_tangent} to represent different phases.

\subsubsection{Uniaxial tension test}

The finite deformation anisotropic model is tested under monotonically
increased uniaxial tension loading. The material properties for both
the matrix and microfibers are listed in Table~
\ref{tab:aniso_material}.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{ l l l l }
      \toprule
      \it{Matrix}:
      &

      &

      \it{Fibers}:

      &
      \\
      Lam\'{e}'s constant
      &
      $\lambda=80$
      &
      Elasticity constants
      &
      $k_1 = k_2 = 100$
      \\
      Shear modulus
      &
      $\mu = 80$
      &
      Elasticity constants
      &
      $q_1 = q_2 = 1.0$
      \\
      Damage variable
      &
      $\xi_{\infty(m)} = 1.0$
      &
      Damage variable
      &
      $\xi_{\infty(1)} = \xi_{\infty(2)} = 1.0$
      \\
      Damage variable
      &
      $\tau_m = 4.0$
      &
      Damage variable
      &
      $\tau_1 = \tau_2 = 4.0$
      \\
      Volume fraction
      &
      $f_m = 0.2$
      &
      Volume fraction
      &
      $f_1 = f_2 = 0.4$
      \\
      &

      &
      Direction vector
      &
      $~M_1 = \{ 0.8,~0.6,~0.0\}$
      \\
      &

      &

      &
      $~M_2 = \{ 0.8,-0.6,~0.0\}$
      \\
      \bottomrule
    \end{tabular}
    \caption{Material properties for anisotropic damage model}
    \label{tab:aniso_material}
  \end{center}
\end{table}

The axial stress vs. stretch behavior in the uniaxial tension test is
shown in Figure~\ref{fig:aniso_stress_stretch}(a). The material
bifurcation is marked on the stress vs. stretch plot. We use the two-
step procedure along with the adaptive time increment to detect
bifurcation, as detailed in Section~\ref{sec:detection}. Figure~
\ref{fig:aniso_stress_stretch}(b) shows the degradation of the
determinant function for all five parametrizations upto the point
material bifurcation is detected. In this loading test, all five
parametrizations detect bifurcation at the same time, i.e., when the
axial component of the deformation gradient $F_{11} = 1.1798$.

\begin{figure}[H]
  \centering \subfigure[]{
    \includegraphics[width=0.45\textwidth]
    {figs/aniso_uniaxial_stress_stretch.pdf}
  } \subfigure[]{
    \includegraphics[width=0.45\textwidth]
    {figs/aniso_uniaxial_mindetA_stretch.pdf}
  }
  \caption{Uniaxial tension test on finite deformation
  anisotropic damage model:
  (a)stress strain behavior, with the cross indicating bifurcation, and
  (b) degradation of det$~A$ for different
  parametrizations.}
  \label{fig:aniso_stress_stretch}
\end{figure}

As in the previous example, the computational cost of different
parametrizations at the loading increment leading to bifurcation is
recorded and shown in Table~\ref{tab:aniso_uniaxial_runtime}. Again,
the density of the initial sampling is represented by the sampling
interval and the number of sampling points. In general, as the number
of sampling points decreases, so does the computational cost. However,
the fewer sampling points may lead to a poor initial guess for the
Newton iterative solve, which may cost more time to arrive at a
converged solution. Because of the added complexity of the material
model, different parametrizations are more sensitive to the density of
the initial sampling grids. The spherical parametrization fails to
correctly detect the bifurcation when the sampling interval is greater
than 0.4. The stereographic, projective and tangent parametrizations,
though more robust in this case, are computationally more expensive.
The Cartesian parametrization is computationally efficient and at the
same time, relatively insensitive to the sampling interval.

\begin{table}[H]
  \begin{center}
    %\begin{tabular}{ p{1.5cm} | p{1.7cm} p{1.7cm} p{1.7cm} p{1.7cm} p{1.7cm} }
    \begin{tabular}{c c | r r r r r}
      \toprule
      Sampling   & Sampling &   \multicolumn{5}{c}{Run time ($\mu$s)}	\\
      interval     & points     &  Spherical    &   Stereographic  &   Projective  &   Tangent   & Cartesian  \\
      \midrule
      0.05      &      41     &      396     &    254       &       5828       &       330        &      412           \\
      0.1        &      21     &      242     &    207       &       926         &       212        &      214           \\
      0.2        &      11     &      188     &    181       &       296         &       187        &      122           \\
      0.3        &      7       &      207     &    210       &       250         &       187        &      132           \\
      0.4        &      5       &      169     &    208       &       268         &       189        &      111           \\
      0.5        &      5       &	  167     &    n/a        &       239         &       n/a         &      123           \\
      0.6        &      3       &	  201     &    173       &       228         &       215        &      281           \\
      0.7        &      3       &	  n/a      &    175 	     &       193         &       157        &      141           \\
      0.8        &      3       &      n/a      &    213       &       187         &       183        &       101          \\
      0.9        &      3       &	  n/a      &    214       &       225         &       204        &       99            \\
      1.0        &      3       &      n/a      &    n/a	     &       225         &       n/a         &       118          \\
      1.5        &      1       &	  n/a      &    n/a	     &       n/a          &       n/a         &       n/a           \\
      \bottomrule
    \end{tabular}
    \caption{Computational cost of different parametrizations in
    uniaxial tension test at loading increment leading to bifurcation.
    `n/a' means the parametrization fails to detect bifurcation in
    this loading increment.}
    \label{tab:aniso_uniaxial_runtime}
  \end{center}
\end{table}

To gain insights into the influence of parametrizations on the
determinant function det$~A$ as loading proceeds, we plot the
landscapes at four different axial stretch levels for different
parametrizations, as shown in Figures~\ref{fig:aniso_spherical_detA} -
\ref{fig:aniso_cartesian_detA}.

\begin{figure}[H]
   \centering \subfigure[$F_{11}=1.0074$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_spherical_detA_F1p0074.pdf}
 } \subfigure[$F_{11}=1.0762$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_spherical_detA_F1p0762.pdf}
 } \subfigure[$F_{11}=1.1583$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_spherical_detA_F1p1583.pdf}
 } \subfigure[$F_{11}=1.1798$ (bifurcation)]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_spherical_detA_F1p1798.pdf}
 }
   \caption{Spherical parametrization: landscapes of det$~A$
   for uniaxial tension test on finite deformation anisotropic model at
   different axial stretch levels.}
   \label{fig:aniso_spherical_detA}
 \end{figure}

\begin{figure}[H]
   \centering \subfigure[$F_{11}=1.0074$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_stereographic_detA_F1p0074.pdf}
 } \subfigure[$F_{11}=1.0762$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_stereographic_detA_F1p0762.pdf}
 } \subfigure[$F_{11}=1.1583$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_stereographic_detA_F1p1583.pdf}
 } \subfigure[$F_{11}=1.1798$ (bifurcation)]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_stereographic_detA_F1p1798.pdf}
 }
   \caption{Stereographic parametrization: landscapes of det$~A$
   for uniaxial tension test on finite deformation anisotropic model at
   different axial stretch levels.}
   \label{fig:aniso_stereographic_detA}
 \end{figure}

\begin{figure}[H]
   \centering \subfigure[$F_{11}=1.0074$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_tangent_detA_F1p0074.pdf}
 } \subfigure[$F_{11}=1.0762$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_tangent_detA_F1p0762.pdf}
 } \subfigure[$F_{11}=1.1583$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_tangent_detA_F1p1583.pdf}
 } \subfigure[$F_{11}=1.1798$ (bifurcation)]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_tangent_detA_F1p1798.pdf}
 }
   \caption{Tangent parametrization: landscapes of det$~A$
   for uniaxial tension test on finite deformation anisotropic model at
   different axial stretch levels.}
   \label{fig:aniso_tangent_detA}
 \end{figure}

\begin{figure}[H]
   \centering \subfigure[$F_{11}=1.0074$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_cartesian_detA_F1p0074.pdf}
 } \subfigure[$F_{11}=1.0762$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_cartesian_detA_F1p0762.pdf}
 } \subfigure[$F_{11}=1.1583$]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_cartesian_detA_F1p1583.pdf}
 } \subfigure[$F_{11}=1.1798$ (bifurcation)]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_cartesian_detA_F1p1798.pdf}
 }
   \caption{Cartesian parametrization: landscapes of det$~A$
   for uniaxial tension test on finite deformation anisotropic model at
   different axial stretch levels.}
   \label{fig:aniso_cartesian_detA}
 \end{figure}

As can be seen from Figure~\ref{fig:aniso_cartesian_detA}, the
Cartesian parametrization again results in a simple `bowl-shaped'
landscape of the determinant function consistently throughout the
loading process, which is in contrast to other more complex landscapes
using alternative parametrizations shown in Figures~
\ref{fig:aniso_spherical_detA} for spherical,
\ref{fig:aniso_stereographic_detA} for stereographic and
\ref{fig:aniso_tangent_detA} for tangent parametrizations.

As in the case of the small deformation model example in
Section \ref{subsec:isotropic}, the robustness of different
parametrizations on the detection of material bifurcation is analyzed
by randomly generating a single initial point for the Newton iterative
solve, i.e., no sweep algorithm is used. A total of 1000 sets of
random initial guess is generated for each parametrization. The
success rate and computational cost are recorded and summarized in
Table~\ref{tab:aniso_axial_random_para}. The results are consistent
with the small deformation model example, i.e., the Cartesian
parametrization is most robust and at the same time, computationally efficient.

\begin{table}[H]
  \begin{center}
    %\begin{tabular}{ lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm} lp{1.5cm}}
    %  \begin{tabular*}{1.0\textwidth}{l | c c c c c}
    \begin{tabular}{l | c c c c c}
      \toprule
        &  Spherical    &   Stereographic   & Projective   &   Tangent   &   Cartesian                 \\
      \midrule
      Success rate ($\%$)                      &    19.4    &    32.3     &    71.5     &    32.3     &     74.4          \\
      Averaged iteration count               &    4.43    &    4.91    &    8.04     &    4.57    &    6.93         \\
      Averaged run time (${\mu}s$)     &    256     &    274     &    483      &    245      &    267         \\
      \bottomrule
    \end{tabular}
    \caption{Anisotropic finite deformation model: success rate and computational cost of Newton iterative solve with a single random initial point. A total of 1000 random trials are performed for each parametrization.}
    \label{tab:aniso_axial_random_para}
  \end{center}
\end{table}

Visualizations of the robustness study with 1000 trial runs are shown
in Figure~\ref{fig:aniso_uniaxial_robust}. If the initial guess leads
to a success detection of bifurcation and its directions, the point
will be marked as a solid circle ($\bullet$). Otherwise, it will be
marked as a cross ($\times$).

\begin{figure}[H]
   \centering \subfigure[Spherical]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_spherical_random.pdf}
 } \subfigure[Cartesian]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_cartesian_random.pdf}
 } \subfigure[Stereographic]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_stereographic_random.pdf}
 } \subfigure[Tangent]{
   \includegraphics[width=0.45\textwidth]
   {figs/aniso_uniaxial_tangent_random.pdf}
 }
   \caption{Anisotropic finite deformation model: results of Newton
   iterative solve with a single random initial point plotted on the
   contour of determinant function at bifurcation. A solid circle
   ($\bullet$) means the initial point leads to a success detection of
   bifurcation and its directions. A cross ($\times$) means the Newton
   iterative solve fails. A total of 1000 random trials are performed
   for each parametrization.}
   \label{fig:aniso_uniaxial_robust}
 \end{figure}

Similar as in the case of the small deformation model example in
Section \ref{subsec:isotropic}, the gradient-based optimization
technique using Newton iterative solve is more likely to achieve
convergence, even when the initial sweep is performed over a
relatively coarse grid or without any initial sweep at all. The
Cartesian parametrization is `optimal' in term of trade-off between
computational efficiency and robustness. In a non-linear large-scale
finite element simulation, this optimal trade-off between
computational efficiency and robustness becomes critical. The
Cartesian parametrization could provide a valuable tool in numerical
bifurcation analysis.

\section{Conclusion}

In this work, efficient and robust algorithms for numerical analysis
of material instability are presented. A sweep-based algorithm
followed by a Newton iterative method is adopted to solve the
minimization problem of material instability. A new Cartesian
parametrization for the normal vectors used to construct the acoustic
tensor is proposed. The computational efficiency and robustness of the
Cartesian parametrization is compared against other common and
uncommon parametrizations of the acoustic tensor by means of numerical
bifurcation analysis of an isotropic small deformation and an
anisotropic large deformation damage model under different loading
conditions. Summarizing results from numerical bifurcation analyses,
it is found that:

\begin{enumerate}
\item[(1)]
The parametrizations of the normal vector significantly affect the
complexity of the objective function to be minimized, which in turn
influences the computational efficiency and robustness of the
algorithm.

\item[(2)]
The commonly used spherical parametrization is efficient provided
that the initial sampling interval is fine enough and the initial
guess is a good approximation to the minimum.

\item[(3)]
The stereographic and tangent parametrizations are the least
robust, i.e., they are more likely to have convergence issues. The
projective parametrization is much more expensive.

\item[(4)]
The Cartesian parametrization is the most robust one for all the
material models and loading conditions tested. It is also
computationally efficient. The Cartesian parametrization represent an
optimal trade-off between computational efficiency and robustness and
could provide a valuable tool for efficient and robust numerical
analysis of material instability in large-scale finite element
analysis.
\end{enumerate}

%\bibliographystyle{plainnat}
\bibliographystyle{unsrtnat}
\bibliography{acpami}

\end{document}
